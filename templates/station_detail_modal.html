{% load static %}
<!-- Full Screen Station Detail Modal -->
<div id="stationDetailModal" class="fixed inset-0 z-[60] hidden" style="background-color: #0B1120;">

    <!-- Header - Fixed at top -->
    <div class="fixed top-0 left-0 right-0 z-10 px-6 py-4 border-b border-gray-700/50 bg-[#0B1120]/95 backdrop-blur-md flex items-center justify-between">
        <div class="flex items-center gap-4">
            <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-cyan-500 to-blue-600 flex items-center justify-center shadow-lg shadow-cyan-500/30">
                <img src="{% static 'sensolog.png' %}"
                         alt="Sensolog Logo"
                         class="w-full h-full object-contain p-1">
            </div>
            <div>
                <h2 id="detailStationName" class="text-xl font-bold text-white">Station Name</h2>
                <p id="detailStationLocation" class="text-sm text-gray-400 flex items-center gap-2">
                    <i class="fas fa-map-marker-alt text-cyan-400"></i>
                    <span>Location</span>
                </p>
            </div>
        </div>

        <!-- Close Button -->
        <button onclick="closeStationDetail()"
                class="group flex items-center gap-2 px-4 py-2 rounded-lg bg-red-500/10 hover:bg-red-500/20 text-red-400 border border-red-500/30 hover:border-red-500/50 transition-all">
            <i class="fas fa-times text-lg group-hover:rotate-90 transition-transform"></i>
            <span class="font-medium">Close</span>
        </button>
    </div>

    <!-- Main Content - Full height minus header -->
    <div class="pt-20 h-screen flex flex-col lg:flex-row">

        <!-- Left Panel - Info & Stats -->
        <div class="w-full lg:w-1/3 h-1/2 lg:h-full overflow-y-auto border-r border-gray-700/50 bg-[#0B1120]">
            <div class="p-6 space-y-6">

                <!-- Quick Stats Grid -->
                <div class="grid grid-cols-2 gap-3">
                    <div class="bg-gray-800/30 rounded-xl p-4 border border-gray-700/30 hover:border-cyan-500/30 transition-all">
                        <p class="text-gray-500 text-xs uppercase tracking-wider mb-1">Station ID</p>
                        <p id="detailStationId" class="text-sm font-bold text-cyan-400 font-mono">#--</p>
                    </div>
                    <div class="bg-gray-800/30 rounded-xl p-4 border border-gray-700/30 hover:border-emerald-500/30 transition-all">
                        <p class="text-gray-500 text-xs uppercase tracking-wider mb-1">Sensors</p>
                        <p id="detailSensorCount" class="text-lg font-bold text-emerald-400">--</p>
                    </div>
                    <div class="bg-gray-800/30 rounded-xl p-4 border border-gray-700/30">
                        <p class="text-gray-500 text-xs uppercase tracking-wider mb-1">Latitude</p>
                        <p id="detailLatitude" class="text-lg font-bold text-white font-mono">--</p>
                    </div>
                    <div class="bg-gray-800/30 rounded-xl p-4 border border-gray-700/30">
                        <p class="text-gray-500 text-xs uppercase tracking-wider mb-1">Longitude</p>
                        <p id="detailLongitude" class="text-lg font-bold text-white font-mono">--</p>
                    </div>
                </div>

                <!-- Map Controls -->
                <div class="bg-gray-800/20 rounded-xl p-5 border border-gray-700/30">
                    <h3 class="text-lg font-semibold text-white mb-4 flex items-center gap-2">
                        <i class="fas fa-map-marked-alt text-cyan-400"></i>
                        Map Controls
                    </h3>
                    <div class="space-y-2">
                        <button onclick="centerMapOnStation()"
                                class="w-full py-2.5 rounded-lg bg-cyan-600/20 hover:bg-cyan-600/30 text-cyan-400 border border-cyan-500/30 transition-all flex items-center justify-center gap-2">
                            <i class="fas fa-crosshairs"></i>
                            Center on Station
                        </button>
                        <button onclick="copyCoordinates()"
                                class="w-full py-2.5 rounded-lg bg-gray-700/50 hover:bg-gray-700 text-gray-300 border border-gray-600/30 transition-all flex items-center justify-center gap-2">
                            <i class="fas fa-copy"></i>
                            Copy Coordinates
                        </button>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="bg-gray-800/20 rounded-xl p-5 border border-gray-700/30">
                    <h3 class="text-lg font-semibold text-white mb-4 flex items-center gap-2">
                        <i class="fas fa-bolt text-amber-400"></i>
                        Quick Actions
                    </h3>
                    <div class="grid grid-cols-2 gap-3">
                        <button onclick="downloadStationData()"
                                class="py-3 rounded-lg bg-blue-600/20 hover:bg-blue-600/30 text-blue-400 border border-blue-500/30 transition-all flex flex-col items-center gap-1 hover:scale-105">
                            <i class="fas fa-download text-lg"></i>
                            <span class="text-xs font-medium">Download</span>
                        </button>
                        <button onclick="openInGoogleMaps()"
                                class="py-3 rounded-lg bg-emerald-600/20 hover:bg-emerald-600/30 text-emerald-400 border border-emerald-500/30 transition-all flex flex-col items-center gap-1 hover:scale-105">
                            <i class="fas fa-external-link-alt text-lg"></i>
                            <span class="text-xs font-medium">Google Maps</span>
                        </button>
                    </div>
                </div>

                <!-- Sensors List -->
                <div class="bg-gray-800/20 rounded-xl p-5 border border-gray-700/30">
                    <h3 class="text-lg font-semibold text-white mb-4 flex items-center gap-2">
                        <i class="fas fa-microchip text-emerald-400"></i>
                        Sensors
                        <span id="detailSensorBadge"
                              class="ml-auto px-3 py-1 rounded-full text-xs bg-emerald-500/10 text-emerald-400 border border-emerald-500/20">0</span>
                    </h3>
                    <div id="detailSensorsList" class="space-y-2 max-h-64 overflow-y-auto scrollbar-hide" style="max-height: fit-content">
                        <div class="text-center text-gray-500 py-4">
                            <i class="fas fa-circle-notch fa-spin mr-2"></i>Loading...
                        </div>
                    </div>
                </div>

                <!-- Metadata -->
                <div class="bg-gray-800/20 rounded-xl p-5 border border-gray-700/30">
                    <h3 class="text-lg font-semibold text-white mb-3 flex items-center gap-2">
                        <i class="fas fa-info-circle text-blue-400"></i>
                        Metadata
                    </h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between py-2 border-b border-gray-700/30">
                            <span class="text-gray-500">Full Coordinates</span>
                            <span id="detailCoordinates" class="text-cyan-400 font-mono text-xs">--</span>
                        </div>
{#                        <div class="flex justify-between py-2 border-b border-gray-700/30">#}
{#                            <span class="text-gray-500">Status</span>#}
{#                            <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-emerald-500/10 text-emerald-400 border border-emerald-500/20">#}
{#                                <span class="w-1.5 h-1.5 rounded-full bg-emerald-400 mr-1.5 animate-pulse"></span>#}
{#                                Active#}
{#                            </span>#}
{#                        </div>#}
                        <div class="flex justify-between py-2">
                            <span class="text-gray-500">Data Source</span>
                            <span class="text-gray-300">Sensor.Community</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Panel - Full Screen Map -->
        <div class="w-full lg:w-2/3 h-1/2 lg:h-full relative bg-gray-900">
            <div id="stationDetailMap" class="w-full h-full z-0"></div>

            <!-- Map Overlay Controls -->
            <div class="absolute top-4 right-4 z-[400] flex flex-col gap-2">
                <button onclick="mapZoomIn()"
                        class="w-10 h-10 rounded-lg bg-gray-800/90 hover:bg-cyan-600 text-white border border-gray-600/50 hover:border-cyan-500 transition-all flex items-center justify-center shadow-lg">
                    <i class="fas fa-plus"></i>
                </button>
                <button onclick="mapZoomOut()"
                        class="w-10 h-10 rounded-lg bg-gray-800/90 hover:bg-cyan-600 text-white border border-gray-600/50 hover:border-cyan-500 transition-all flex items-center justify-center shadow-lg">
                    <i class="fas fa-minus"></i>
                </button>
                <button onclick="centerMapOnStation()"
                        class="w-10 h-10 rounded-lg bg-gray-800/90 hover:bg-cyan-600 text-white border border-gray-600/50 hover:border-cyan-500 transition-all flex items-center justify-center shadow-lg"
                        title="Center on station">
                    <i class="fas fa-crosshairs"></i>
                </button>
            </div>

            <!-- Map Legend -->
            <div class="absolute bottom-4 left-4 z-[400] bg-gray-800/90 backdrop-blur-sm rounded-lg p-3 border border-gray-600/50">
                <div class="flex items-center gap-2 text-xs text-gray-300">
                    <span class="w-3 h-3 rounded-full bg-cyan-500 shadow-lg shadow-cyan-500/50"></span>
                    <span>Current Station</span>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    /* Custom scrollbar for left panel */
    .scrollbar-hide::-webkit-scrollbar {
        display: none;
    }

    .scrollbar-hide {
        -ms-overflow-style: none;
        scrollbar-width: none;
    }

    /* Leaflet dark mode overrides */
    .leaflet-container {
        background: #0B1120 !important;
    }

    .leaflet-popup-content-wrapper {
        background: rgba(21, 30, 50, 0.95) !important;
        color: white !important;
        border: 1px solid rgba(0, 217, 255, 0.3) !important;
        border-radius: 0.75rem !important;
    }

    .leaflet-popup-tip {
        background: rgba(21, 30, 50, 0.95) !important;
    }

    .leaflet-control-attribution {
        background: rgba(11, 17, 32, 0.8) !important;
        color: #64748b !important;
    }

    .leaflet-control-attribution a {
        color: #00D9FF !important;
    }
</style>