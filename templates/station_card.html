<div class="sensors-container bg-dark-900/30">
    {% if station.get_sensor_data %}
        <!-- Header -->
        <div class="p-4 border-b border-white/5 flex items-center justify-between">
            <div class="flex items-center gap-2">
                <i class="fas fa-microchip text-cyan-400"></i>
                <h4 class="text-white font-semibold text-sm">
                    Sensors ({{ station.get_sensor_data|length }})
                </h4>
            </div>

            <button onclick="toggleSensorsList(this)"
                    class="expand-btn px-3 py-1.5 rounded-lg bg-dark-700/50
                           hover:bg-dark-700 text-gray-400 hover:text-white
                           border border-white/10 transition-all
                           flex items-center gap-2 text-xs">
                <span class="toggle-text">Expand</span>
                <i class="fas fa-chevron-down toggle-icon transition-transform"></i>
            </button>
        </div>

        <!-- Collapsible List -->
        <div class="sensors-list-content
                    p-4 space-y-3
                    overflow-hidden
                    transition-[max-height,opacity]
                    duration-300 ease-in-out"
             style="max-height:0; opacity:0;">

            {% for sensor in station.get_sensor_data %}
                <div class="sensor-row flex items-center justify-between
                            p-3 rounded-xl
                            bg-dark-800/40 border border-white/5
                            hover:border-cyan-500/30 hover:bg-dark-800/60
                            transition-all">

                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 rounded-lg bg-slate-700/50
                                    flex items-center justify-center text-cyan-400">
                            {% if "SDS011" in sensor.sensor_type.name %}
                                <i class="fas fa-smog"></i>
                            {% elif "DHT22" in sensor.sensor_type.name %}
                                <i class="fas fa-temperature-half"></i>
                            {% elif "BMP180" in sensor.sensor_type.name %}
                                <i class="fas fa-gauge"></i>
                            {% else %}
                                <i class="fas fa-microchip"></i>
                            {% endif %}
                        </div>

                        <div>
                            <h4 class="text-white font-semibold text-sm">
                                ID: {{ sensor.sensor_id }} â€¢ {{ sensor.sensor_type.name }}
                            </h4>

                            {% with values=sensor.get_sensor_data_value %}
                                {% if values %}
                                    {% for key, data in values.items %}
                                        <p class="text-xs text-cyan-400 mt-0.5">
                                            {{ key }}:
                                            <span class="text-white font-medium">
                                                {{ data.value }}
                                            </span>
                                        </p>
                                        <p class="text-[10px] text-gray-500">
                                            Updated at: {{ data.timestamp|date:"H:i A" }}
                                        </p>
                                    {% endfor %}
                                {% else %}
                                    <p class="text-xs text-gray-500 mt-0.5">
                                        No data today
                                    </p>
                                {% endif %}
                            {% endwith %}
                        </div>
                    </div>

                    <div class="flex items-center gap-3">
                        <button onclick="downloadSensor(this, {{ station.id }}, {{ sensor.sensor_id }}, '{{ station.uid }}')"
                                class="w-8 h-8 rounded-lg bg-slate-700/30
                                       hover:bg-cyan-500/20 text-gray-400
                                       hover:text-cyan-400 transition-colors
                                       flex items-center justify-center
                                       border border-white/5 hover:border-cyan-500/30">
                            <i class="fas fa-download text-xs"></i>
                        </button>
                        <label class="relative inline-flex items-center cursor-pointer group">
                            <input type="checkbox"
                                   class="sensor-checkbox sr-only"
                                   data-sensor-id="{{ sensor.sensor_id }}"
                                   data-station-id="{{ station.id }}"
                                   onchange="updateSelection()">

                            <div class="w-5 h-5 rounded border border-gray-600 group-has-[:checked]:border-cyan-500 transition-all flex items-center justify-center">
                                <i class="fa-solid fa-check text-cyan-500 text-xs hidden group-has-[:checked]:block transition-opacity"></i>
                            </div>
                        </label>

                    </div>
                </div>
            {% endfor %}
        </div>
    {% endif %}
</div>
