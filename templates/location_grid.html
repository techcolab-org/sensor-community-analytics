<div class="columns-1 lg:columns-2 gap-6 space-y-6" id="locationsGrid">
    {% for station in stations %}
        {% with station_uid=station.id|stringformat:"s" %}
            <div id="station-{{ station.uid }}"
                 class="location-card glass-panel rounded-2xl overflow-hidden flex flex-col break-inside-avoid mb-6"
                 data-status="{{ station.location.status }}" data-name="{{ station.name|lower }}"
                 data-station-id="{{ station.id }}">
                <!-- Card Header -->
                <div class="p-5 border-b border-white/5 bg-gradient-to-r from-dark-800/50 to-transparent">
                    <div class="flex items-start justify-between mb-2">
                        <div class="flex items-center gap-2">
                            <i class="fas fa-map-marker-alt text-red-500"></i>
                            <h3 class="text-lg font-bold text-white">{{ station.name }}</h3>
                        </div>
                        <button onclick="openStationDetail('{{ station.id }}')"
                                    class="px-3 py-1.5 rounded-lg bg-blue-600/20 hover:bg-blue-600/30 text-blue-400 border border-blue-500/30 transition-all flex items-center gap-2 text-xs font-medium">
                                <i class="fas fa-expand"></i>
                                View Details
                            </button>
                    </div>

                    <div class="flex flex-col items-start gap-4 text-sm text-gray-400 mt-2">
                            <span class="flex items-center gap-1.5">
                                <i class="fas fa-globe-americas text-gray-500"></i>
                                {{ station.location_name | default:"Location not set" }}
                            </span>
                        <div class="flex justify-between items-center w-full">
                                <span class="flex items-center  gap-1.5">
                                    <i class="fas fa-crosshairs text-red-400"></i>
                                    {{ station.location.coords }}
                                </span>

                            <label class="relative inline-flex items-center cursor-pointer group">
                                <input type="checkbox"
                                       class="station-checkbox sr-only"
                                       data-id="{{ station.id }}"
                                       onchange="updateStationSelection()">

                                <div class="w-5 h-5 rounded border border-gray-600 group-has-[:checked]:border-cyan-500 transition-all flex items-center justify-center">
                                    <i class="fa-solid fa-check text-cyan-500 text-xs hidden group-has-[:checked]:block transition-opacity"></i>
                                </div>
                            </label>
                        </div>

                    </div>
                </div>

                <div class="location-card rounded-2xl bg-dark-800/40 border border-white/5 overflow-hidden">
                    {% include "station_card.html" %}
                </div>


                <!-- Card Footer -->
                <div class="p-4 border-t border-white/5 bg-dark-800/30 flex gap-3">
                    {% if station.get_sensor_data %}
                        <button onclick="selectAllInLocation(this)"
                                class="flex-1 py-2.5 rounded-lg bg-dark-700/50 hover:bg-dark-700 text-white text-sm font-medium transition-colors border border-white/10">
                            Select All
                        </button>
                        <button onclick="openSensorModal('{{ station.id }}', '{{ station.name }}')"
                                class="px-4 py-2.5 rounded-lg bg-emerald-600/20 hover:bg-emerald-600/30 text-emerald-400 border border-emerald-500/30 transition-all flex items-center gap-2 text-sm font-medium">
                            <i class="fas fa-plus"></i>
                            Sensor
                        </button>
                        <button onclick="downloadLocation(this, '{{ station.name }}', false)"
                                class="flex-1 py-2.5 rounded-lg bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 text-white text-sm font-semibold shadow-lg shadow-cyan-500/20 transition-all flex items-center justify-center gap-2">
                            <i class="fas fa-download"></i>
                            Download Data
                        </button>
                    {% else %}
                        <button onclick="openSensorModal('{{ station.id }}', '{{ station.name }}')"
                                class="flex-1 py-2.5 rounded-lg bg-emerald-600/20 hover:bg-emerald-600/30 text-emerald-400  text-sm font-semibold shadow-lg shadow-emerald-500/20 transition-all flex items-center justify-center gap-2">
                            <i class="fas fa-plus"></i>
                            Add Sensor
                        </button>
                    {% endif %}
                </div>
            </div>
        {% endwith %}
    {% empty %}
        <div class="text-center py-12 text-gray-500 break-inside-avoid">
            <i class="fas fa-inbox text-4xl mb-3 opacity-20"></i>
            <p>No sensor locations found</p>
        </div>
    {% endfor %}
</div>